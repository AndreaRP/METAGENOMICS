#!/bin/bash
set -e
#########################################################
#		  		BACTERIA BLAST WRAPPER				 	#
#########################################################

# 1. Runs blast.sh* with every sample included in samples_id.txt**
# * Note: This script must only be used after running wrapper_bacteria_assembly.sh
# ** Note: the file samples_id.txt is generated by samplesID_gen.sh


#       CONSTANTS
source ./pikaVirus.config
source ${analysisDir}/SRC/blast.sh
samplesIdFile="${analysisDir}/samples_id.txt"

if [ "${cluster}" -eq "yes" ] # qsub -V -j y -b y -cwd -t 1-number of samples -q all.q -N name command
then
	in=$(awk "NR==$SGE_TASK_ID" $samplesIdFile)
	sampleDir="${analysisDir}/05-bacteria/${in}/"
	echo ${in}
	blast $sampleDir $bacDB
else
	cat ${analysisDir}/samples_id.txt | while read in
	do
		echo 'hola $in'
		sampleDir="${analysisDir}/05-bacteria/${in}/"
		blast $sampleDir $bacDB
	done
fi

